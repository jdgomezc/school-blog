---
import Layout from '@/layouts/Layout.astro';
import ImagesCarousel from "@/components/ImagesCarousel"
import Post from "@/components/Post.astro"

const apiURL = new URL("/api/posts/filtered.json?type=POST", Astro.url);

const posts: Post[] = await fetch(apiURL, {
          method: 'GET',
        })
		.then(res => res.json())
		.then(data => {
			return data;
		});

---

<Layout home="true">
	<ImagesCarousel client:load />
	<article class="px-8 2xl:px-24 py-16 grid grid-cols-3 gap-y-16 w-full justify-items-center">
		{
			posts.map(({id, title, description, date, type, author}) => (
				<Post
					id={id}
					title={title}
					content={description}
					date={date}
					type={type}
					author={author}
				/>
			))
		}
	</article>
</Layout>
